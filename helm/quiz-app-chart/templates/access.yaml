# Admin for the entire Namespace
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: role:admin
  namespace: {{ .Values.namespaces.app | quote }}
  labels:
    app: quiz-app
    module: access-control
rules:
  - apiGroups: ["", "cert-manager.io", "networking.k8s.io"]
    resources: ["*"]
    verbs: ["*"]

---

# Visitor role that is only allowed to see but not change
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: role:visitor
  namespace: {{ .Values.namespaces.app | quote }}
  labels:
    app: quiz-app
    module: access-control
rules:
  - apiGroups: ["", "networking.k8s.io"]
    resources: ["pods", "pods/logs", "services"]
    verbs: ["get", "list", "watch"]

---

# Set "adrian" as an Admin
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: rolebinding:admin
  namespace: {{ .Values.namespaces.app | quote }}
  labels:
    app: quiz-app
    module: access-control
subjects:
  - kind: User
    name: adrian
    namespace: {{ .Values.namespaces.app | quote }}
roleRef:
  kind: Role
  name: role:admin
  apiGroup: rbac.authorization.k8s.io

---

# Set "veronica" as a Visitor
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: rolebinding:visitor
  namespace: {{ .Values.namespaces.app | quote }}
  labels:
    app: quiz-app
    module: access-control
subjects:
  - kind: User
    name: veronica
    namespace: {{ .Values.namespaces.app | quote }}
roleRef:
  kind: Role
  name: role:visitor
  apiGroup: rbac.authorization.k8s.io